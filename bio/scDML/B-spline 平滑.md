![1](/bio/scDML/pictures/3fed11b4-0751-480d-b29b-e797765e1ba3.png)
ä¸Šå›¾ç›´è§‚å±•ç¤ºäº† **ä¸‰æ¬¡ B-spline å¹³æ»‘æ›²çº¿** æ˜¯å¦‚ä½•ä»ä¸€ç»„å¸¦æœ‰å™ªå£°çš„åŸå§‹æ•°æ®ç‚¹ä¸­æå–æ•´ä½“è¶‹åŠ¿çš„ï¼š

- âš« é»‘è‰²åœ†ç‚¹è¡¨ç¤ºåŸå§‹æ•°æ®ç‚¹ï¼Œå¸¦æœ‰ä¸€å®šçš„éšæœºå™ªå£°ã€‚
- ğŸ”µ è“è‰²å¹³æ»‘æ›²çº¿æ˜¯é€šè¿‡ **ä¸‰æ¬¡ B æ ·æ¡ï¼ˆdegree=3ï¼‰** å¾—åˆ°çš„æ‹Ÿåˆç»“æœï¼Œå®ƒæ¯”ç®€å•è¿çº¿æˆ–é«˜æ¬¡å¤šé¡¹å¼æ‹Ÿåˆæ›´è‡ªç„¶ã€å¹³æ»‘ã€‚
- ğŸ”µ è“è‰²é˜´å½±åŒºåŸŸè¡¨ç¤ºä¸€ä¸ªæ¨¡æ‹Ÿçš„è¯¯å·®å¸¦ï¼ˆÂ±0.3ï¼‰ï¼Œåœ¨å®é™…ç§‘ç ”å›¾ä¸­ï¼Œå®ƒå¯ä»¥æ˜¯ **95%ç½®ä¿¡åŒºé—´** çš„ä¼°è®¡èŒƒå›´ã€‚

å¦‚æœä½ æ­£åœ¨å¤„ç†æ—¶é—´åºåˆ—ã€å®éªŒæµ‹é‡æ•°æ®ï¼Œæˆ–å¯è§†åŒ–èšç±»è¯„ä»·æŒ‡æ ‡å˜åŒ–è¶‹åŠ¿ï¼Œè¿™ç§å¹³æ»‘æ–¹å¼ç‰¹åˆ«å¸¸ç”¨ã€‚

è¦ä¸è¦æˆ‘ç”¨ä½ çš„æ•°æ®æ¥æ¼”ç¤ºä¸€é B-spline å¹³æ»‘ï¼Ÿæˆ–è€…ä½ æƒ³çœ‹çœ‹å®ƒå’Œå…¶ä»–æ–¹æ³•ï¼ˆæ¯”å¦‚ç§»åŠ¨å¹³å‡ã€ä½é˜¶å¤šé¡¹å¼æ‹Ÿåˆï¼‰çš„å¯¹æ¯”å›¾ï¼Ÿ

å½“ç„¶å¯ä»¥ï¼ä»¥ä¸‹æ˜¯ä½ åˆšæ‰çœ‹åˆ°å›¾çš„å®Œæ•´ Python ç¤ºä¾‹ä»£ç ï¼Œä½¿ç”¨äº† `scipy` çš„ `make_interp_spline` æ¥è¿›è¡Œ **ä¸‰æ¬¡ B-spline å¹³æ»‘**ï¼Œå¹¶ç»˜åˆ¶åŸå§‹æ•°æ®ç‚¹ã€å¹³æ»‘æ›²çº¿å’Œè¯¯å·®å¸¦ï¼š

---

### âœ… ç¤ºä¾‹ï¼šä¸‰æ¬¡ B-spline å¹³æ»‘ä¸è¯¯å·®å¸¦å¯è§†åŒ–

```python
import numpy as np
import matplotlib.pyplot as plt
from scipy.interpolate import make_interp_spline

# æ¨¡æ‹Ÿä¸€ç»„å¸¦å™ªå£°çš„æ•°æ®ç‚¹
np.random.seed(0)
x = np.linspace(0, 10, 15)
y = np.sin(x) + np.random.normal(scale=0.3, size=x.shape)

# æ„é€  B-spline å¹³æ»‘æ›²çº¿ï¼ˆdegree=3ï¼‰
x_smooth = np.linspace(x.min(), x.max(), 300)  # æ›´å¯†çš„xï¼Œç”¨äºç»˜å›¾
spline = make_interp_spline(x, y, k=3)         # k=3 è¡¨ç¤ºä¸‰æ¬¡ B æ ·æ¡
y_smooth = spline(x_smooth)

# ç»˜åˆ¶å›¾åƒ
plt.figure(figsize=(10, 6))
plt.plot(x, y, 'o', label='åŸå§‹æ•°æ®ç‚¹', color='black')
plt.plot(x_smooth, y_smooth, label='ä¸‰æ¬¡ B-spline å¹³æ»‘æ›²çº¿', color='blue', linewidth=2)

# æ¨¡æ‹Ÿè¯¯å·®å¸¦ Â±0.3ï¼Œå¯æ ¹æ®å®é™…ç½®ä¿¡åŒºé—´è®¡ç®—
plt.fill_between(x_smooth, y_smooth - 0.3, y_smooth + 0.3, 
                 color='blue', alpha=0.2, label='è¯¯å·®å¸¦ï¼ˆÂ±0.3ï¼‰')

# è®¾ç½®æ ‡é¢˜å’Œæ ‡ç­¾
plt.title("ä¸‰æ¬¡ B-spline å¹³æ»‘æ›²çº¿ä¸è¯¯å·®å¸¦")
plt.xlabel("x")
plt.ylabel("y")
plt.legend()
plt.grid(True)
plt.tight_layout()
plt.show()
```

---

### ğŸ“¦ ä¾èµ–é¡¹ï¼ˆå¦‚æœªå®‰è£…ï¼‰ï¼š
ä½ å¯èƒ½éœ€è¦å…ˆå®‰è£…ä»¥ä¸‹åº“ï¼š

```bash
pip install numpy matplotlib scipy
```

---

### ğŸ“Œ å¯é€‰æ”¹è¿›ï¼š
- æŠŠ `Â±0.3` æ›¿æ¢æˆçœŸå®çš„æ ‡å‡†è¯¯å·®æˆ–ç½®ä¿¡åŒºé—´ä¼°è®¡ï¼›
- å°† `make_interp_spline` æ›¿æ¢æˆæ›´é€‚åˆå¤§å‹æ•°æ®çš„ `UnivariateSpline`ï¼›
- å¦‚æœä½ çš„æ•°æ®æ˜¯æ—¶é—´åºåˆ—ï¼Œè¿˜å¯ä»¥åŠ æ—¶é—´åæ ‡è½´æ ¼å¼ã€‚

---

éœ€è¦æˆ‘ç»™ä½ å±•ç¤º **ç½®ä¿¡åŒºé—´çš„çœŸå®è®¡ç®—æ–¹å¼** æˆ–æŠŠå®ƒå’Œ **ç§»åŠ¨å¹³å‡/å¤šé¡¹å¼æ‹Ÿåˆ** åšå¯¹æ¯”ä¹Ÿæ²¡é—®é¢˜ï¼Œç›´æ¥è¯´ä¸€å£°å°±è¡Œã€‚