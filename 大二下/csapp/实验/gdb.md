# 0. ç¼–è¯‘æŒ‡ä»¤
`disassemble main [/m]`
/m cå’Œasmä¸€èµ·æ’åˆ—   
/r çœ‹16è¿›åˆ¶ä»£ç  
gcc -O0 -no-pie -ggdb floatequ.c -o floatequ
gcc -m32 -O0 -no-pie -g memory.c -o m32
gcc -O0 -no-pie -g memory.c -o m
# 1. pçš„æ ¼å¼åŒ–æ‰“å°
åœ¨ `gdb` ä¸­ï¼Œ`p`ï¼ˆ`print`ï¼‰å‘½ä»¤æ”¯æŒå¤šç§æ ¼å¼åŒ–æ‰“å°æ–¹å¼ï¼Œå¸¸è§çš„æ ¼å¼å‰ç¼€å¦‚ä¸‹ï¼š  

| æ ¼å¼å‰ç¼€  | è¯´æ˜                    | ç¤ºä¾‹ |
|----------|----------------------|----------------------------|
| `/x`     | ä»¥ **åå…­è¿›åˆ¶** è¾“å‡º    | `p/x $rsp` -> `0x7ffffffde000` |
| `/d`     | ä»¥ **åè¿›åˆ¶** è¾“å‡º      | `p/d n` -> `1234` |
| `/u`     | ä»¥ **æ— ç¬¦å·åè¿›åˆ¶** è¾“å‡º | `p/u n` -> `4294967295` |
| `/o`     | ä»¥ **å…«è¿›åˆ¶** è¾“å‡º      | `p/o n` -> `0177777` |
| `/t`     | ä»¥ **äºŒè¿›åˆ¶** è¾“å‡º      | `p/t n` -> `0b101010` |
| `/c`     | ä»¥ **å­—ç¬¦** è¾“å‡º        | `p/c ch` -> `'A'` |
| `/s`     | ä»¥ **å­—ç¬¦ä¸²** è¾“å‡º      | `p/s str` -> `"hello"` |
| `/a`     | ä»¥ **åœ°å€** è¾“å‡º        | `p/a ptr` -> `0x555555554000` |

---

## **ç¤ºä¾‹**
### **1. æ‰“å°å¯„å­˜å™¨çš„åå…­è¿›åˆ¶å€¼**
```gdb
(gdb) p/x $rsp
$1 = 0x7ffffffde000
```

### **2. æ‰“å°å˜é‡çš„ä¸åŒæ ¼å¼**
```c
int n = 42;
char ch = 'A';
char str[] = "hello";
```
```gdb
(gdb) p/x n   # åå…­è¿›åˆ¶
$2 = 0x2a
(gdb) p/d n   # åè¿›åˆ¶
$3 = 42
(gdb) p/t n   # äºŒè¿›åˆ¶
$4 = 0b101010
(gdb) p/o n   # å…«è¿›åˆ¶
$5 = 052
(gdb) p/c ch  # å­—ç¬¦
$6 = 'A'
(gdb) p/s str # å­—ç¬¦ä¸²
$7 = "hello"
```

### **3. æ‰“å°æŒ‡é’ˆçš„åœ°å€**
```gdb
(gdb) p/a &n
$8 = 0x7fffffffdc4c
```

---

## **é¢å¤–æŠ€å·§**
å¦‚æœä½ æƒ³ä¸€æ¬¡æ‰“å°å¤šä¸ªå˜é‡ï¼š
```gdb
(gdb) print/x n, ch, &n
$9 = 0x2a
$10 = 0x41
$11 = (int *) 0x7fffffffdc4c
```
ä½ ä¹Ÿå¯ä»¥ç”¨ `set print` å‘½ä»¤æ¥å…¨å±€ä¿®æ”¹é»˜è®¤çš„æ ¼å¼ï¼š
```gdb
(gdb) set print pretty on   # è®©ç»“æ„ä½“ã€æ•°ç»„ç­‰æ‰“å°å¾—æ›´ç¾è§‚
(gdb) set print elements 10 # é™åˆ¶æ•°ç»„æ‰“å°çš„å…ƒç´ ä¸ªæ•°
```

å¦‚æœä½ æƒ³æ¯æ¬¡éƒ½é»˜è®¤ä»¥ **åå…­è¿›åˆ¶** æ‰“å°ï¼š
```gdb
(gdb) set output-radix 16
```
è¿™æ ·åç»­çš„ `p` å‘½ä»¤éƒ½ä¼šä»¥ **åå…­è¿›åˆ¶** æ˜¾ç¤ºã€‚

---

### **æ€»ç»“**
- **å¸¸ç”¨æ ¼å¼**ï¼š`p/x`ï¼ˆåå…­è¿›åˆ¶ï¼‰ï¼Œ`p/d`ï¼ˆåè¿›åˆ¶ï¼‰ï¼Œ`p/t`ï¼ˆäºŒè¿›åˆ¶ï¼‰ï¼Œ`p/o`ï¼ˆå…«è¿›åˆ¶ï¼‰ã€‚
- **å­—ç¬¦ä¸²** ç”¨ `p/s`ï¼Œ**å­—ç¬¦** ç”¨ `p/c`ï¼Œ**åœ°å€** ç”¨ `p/a`ã€‚
- **å¯ä»¥å…¨å±€ä¿®æ”¹é»˜è®¤æ ¼å¼**ï¼Œç”¨ `set output-radix 16` è®©æ‰€æœ‰è¾“å‡ºé»˜è®¤ä½¿ç”¨åå…­è¿›åˆ¶ã€‚

è¿™æ ·ä½ å°±å¯ä»¥æ›´æ–¹ä¾¿åœ°åˆ†æ `gdb` é‡Œçš„æ•°æ®å•¦ï¼ğŸš€

# 2. ä¼˜åŒ–çº§åˆ«

åœ¨ GCCï¼ˆGNU Compiler Collectionï¼‰ç­‰ç¼–è¯‘å™¨ä¸­ï¼Œ`-O0`ã€`-O1`ã€`-O2`ã€`-O3`ã€`-Og` ç­‰ä¼˜åŒ–çº§åˆ«ç”¨äºæ§åˆ¶ç¼–è¯‘å™¨å¯¹ä»£ç è¿›è¡Œçš„ä¼˜åŒ–ç¨‹åº¦ã€‚ä¸åŒçš„ä¼˜åŒ–çº§åˆ«ä¼šå½±å“ä»£ç çš„æ‰§è¡Œé€Ÿåº¦ã€ä»£ç å¤§å°ä»¥åŠè°ƒè¯•ä¿¡æ¯çš„å¯ç”¨æ€§ã€‚

---

## 1. `-O0`ï¼ˆæ— ä¼˜åŒ–ï¼‰
- **ç‰¹ç‚¹**ï¼š
  - å®Œå…¨ä¸è¿›è¡Œä¼˜åŒ–ï¼Œä¿æŒä»£ç å°½å¯èƒ½æ¥è¿‘æºä»£ç é€»è¾‘ã€‚
  - å˜é‡ä¸ä¼šè¢«å¯„å­˜å™¨æ›¿ä»£ï¼Œæ‰€æœ‰å˜é‡éƒ½å­˜å‚¨åœ¨å†…å­˜ä¸­ã€‚
  - é€‚ç”¨äº **è°ƒè¯•**ï¼Œå› ä¸ºå¯ç›´æ¥æ˜ å°„åˆ°æºä»£ç çš„æ¯ä¸€è¡Œã€‚
  - ä»£ç æ‰§è¡Œé€Ÿåº¦è¾ƒæ…¢ï¼Œç¨‹åºä½“ç§¯è¾ƒå¤§ã€‚
  
- **ä½¿ç”¨åœºæ™¯**ï¼š
  - ä»£ç å¼€å‘é˜¶æ®µï¼Œä¾¿äºè°ƒè¯•ã€‚
  - éœ€è¦æŸ¥çœ‹å®Œæ•´çš„åæ±‡ç¼–ä»£ç ä»¥ç ”ç©¶å†…å­˜å¸ƒå±€ã€‚

---

## 2. `-Og`ï¼ˆé€‚ç”¨äºè°ƒè¯•çš„ä¼˜åŒ–ï¼‰
- **ç‰¹ç‚¹**ï¼š
  - é€‚ç”¨äºè°ƒè¯•çš„ä¼˜åŒ–çº§åˆ«ï¼ˆ"Optimization for debugging"ï¼‰ã€‚
  - è¿›è¡Œéƒ¨åˆ†ä¼˜åŒ–ï¼Œä½¿ä»£ç è¿è¡Œæ›´é«˜æ•ˆï¼ŒåŒæ—¶ä¿ç•™å¤§éƒ¨åˆ†è°ƒè¯•ä¿¡æ¯ã€‚
  - æ¯” `-O0` ç”Ÿæˆçš„ä»£ç æ›´å¿«ï¼Œä½†ä»ç„¶é€‚åˆå•æ­¥è°ƒè¯•ã€‚

- **ä½¿ç”¨åœºæ™¯**ï¼š
  - éœ€è¦è°ƒè¯•çš„æƒ…å†µä¸‹ï¼Œæƒ³è¦ä¸€å®šçš„ä¼˜åŒ–ä½†åˆä¸èƒ½å½±å“è°ƒè¯•è¿‡ç¨‹ã€‚

---

## 3. `-O1`ï¼ˆåŸºæœ¬ä¼˜åŒ–ï¼‰
- **ç‰¹ç‚¹**ï¼š
  - è¿›è¡ŒåŸºæœ¬ä¼˜åŒ–ï¼Œå‡å°‘ä»£ç å¤§å°ï¼Œæé«˜æ‰§è¡Œæ•ˆç‡ã€‚
  - å¯èƒ½ä¼šè¿›è¡Œ **å¸¸é‡åˆå¹¶ã€æ­»ä»£ç æ¶ˆé™¤ã€ç®€å•å¾ªç¯ä¼˜åŒ–** ç­‰ä¼˜åŒ–ã€‚
  - ä»£ç ä»ç„¶æ¯”è¾ƒå®¹æ˜“è°ƒè¯•ï¼Œä½†å¯èƒ½ä¸ä¼šä¸æºä»£ç  1:1 å¯¹åº”ã€‚

- **ä½¿ç”¨åœºæ™¯**ï¼š
  - é€‚ç”¨äºéœ€è¦ä¸€å®šä¼˜åŒ–ä½†ä»ç„¶è¦ä¿æŒä»£ç å¯è¯»æ€§çš„æƒ…å†µã€‚
  - ä¸€èˆ¬ç”¨äºå¼€å‘é˜¶æ®µçš„ **æµ‹è¯•ç‰ˆæœ¬**ã€‚

---

## 4. `-O2`ï¼ˆå¸¸ç”¨ä¼˜åŒ–ï¼‰
- **ç‰¹ç‚¹**ï¼š
  - è¿›è¡Œ **æ›´é«˜çº§çš„ä¼˜åŒ–**ï¼Œä½¿ç¨‹åºè¿è¡Œæ›´å¿«ã€‚
  - åŒ…æ‹¬ï¼š
    - **å¾ªç¯ä¼˜åŒ–**ï¼ˆå¦‚å±•å¼€å¾ªç¯ã€å‡å°‘åˆ†æ”¯ï¼‰
    - **æŒ‡ä»¤è°ƒåº¦**ï¼ˆå‡å°‘æµæ°´çº¿é˜»å¡ï¼‰
    - **æ¶ˆé™¤ä¸å¿…è¦çš„å­˜å‚¨å’ŒåŠ è½½æ“ä½œ**
    - **å‡å°‘æ ˆä½¿ç”¨**
  - ä»£ç ä½“ç§¯é€šå¸¸æ¯” `-O1` æ›´å°ï¼Œæ‰§è¡Œé€Ÿåº¦æ›´å¿«ã€‚

- **ä½¿ç”¨åœºæ™¯**ï¼š
  - **æ¨èç”¨äºç”Ÿäº§ç¯å¢ƒ**ï¼Œå› ä¸ºå®ƒèƒ½å¤§å¹…æå‡æ€§èƒ½ä¸”ä¸ä¼šæ¿€è¿›åœ°ä¼˜åŒ–ä»£ç ï¼ˆä¸ä¼šå½±å“ç¨‹åºè¡Œä¸ºï¼‰ã€‚

---

## 5. `-O3`ï¼ˆæœ€é«˜çº§ä¼˜åŒ–ï¼‰
- **ç‰¹ç‚¹**ï¼š
  - åœ¨ `-O2` çš„åŸºç¡€ä¸Šè¿›è¡Œæ›´æ¿€è¿›çš„ä¼˜åŒ–ï¼š
    - **è‡ªåŠ¨å‘é‡åŒ–**ï¼ˆSIMDï¼‰
    - **æ›´æ¿€è¿›çš„å‡½æ•°å†…è”**
    - **å†—ä½™è®¡ç®—æ¶ˆé™¤**
    - **æ›´å¼ºçš„å¾ªç¯ä¼˜åŒ–**
  - å¯èƒ½ä¼šæ”¹å˜æŸäº›ä»£ç çš„è¡Œä¸ºï¼ˆå¦‚æœªå®šä¹‰è¡Œä¸ºï¼‰ã€‚
  - ä»£ç æ‰§è¡Œé€Ÿåº¦æœ€å¿«ï¼Œä½†å¯èƒ½å¢åŠ ç¨‹åºä½“ç§¯ã€‚

- **ä½¿ç”¨åœºæ™¯**ï¼š
  - éœ€è¦æè‡´æ€§èƒ½ä¼˜åŒ–çš„åœºåˆï¼Œå¦‚ **ç§‘å­¦è®¡ç®—ã€é«˜æ€§èƒ½æœåŠ¡å™¨**ã€‚
  - å¯èƒ½ä¼šå¯¼è‡´æŸäº›ä»£ç éš¾ä»¥è°ƒè¯•æˆ–è¡Œä¸ºæ”¹å˜ã€‚

---

## 6. `-Ofast`ï¼ˆè¶…æ¿€è¿›ä¼˜åŒ–ï¼‰
- **ç‰¹ç‚¹**ï¼š
  - åœ¨ `-O3` åŸºç¡€ä¸Šï¼Œ**å¿½ç•¥ IEEE 754 æµ®ç‚¹æ•°æ ‡å‡†**ï¼Œè¿›è¡Œæ›´æ¿€è¿›çš„ä¼˜åŒ–ï¼š
    - **å»é™¤ NaN å’Œæ— ç©·å¤§æ£€æŸ¥**
    - **å…è®¸æµ®ç‚¹æ•°è®¡ç®—é‡æ’åº**
    - **å¿½ç•¥ä¸¥æ ¼çš„æ ‡å‡†è¦æ±‚**
  - **å¯èƒ½å¯¼è‡´æ•°å€¼è®¡ç®—ä¸å‡†ç¡®**ï¼Œä½†é€Ÿåº¦æ›´å¿«ã€‚

- **ä½¿ç”¨åœºæ™¯**ï¼š
  - é€‚ç”¨äº **é«˜æ€§èƒ½è®¡ç®—**ï¼Œä½†ä¸é€‚ç”¨äºéœ€è¦ä¸¥æ ¼æ•°å€¼ç²¾åº¦çš„åº”ç”¨ï¼ˆå¦‚é‡‘èã€å¯†ç å­¦ï¼‰ã€‚

---

## 7. `-Os`ï¼ˆä¼˜åŒ–ä»£ç å¤§å°ï¼‰
- **ç‰¹ç‚¹**ï¼š
  - åœ¨ `-O2` çš„åŸºç¡€ä¸Šè¿›ä¸€æ­¥ä¼˜åŒ– **ä»£ç å¤§å°**ï¼Œå‡å°‘æŒ‡ä»¤æ•°é‡ã€‚
  - é€‚ç”¨äº **åµŒå…¥å¼ç³»ç»Ÿã€å­˜å‚¨å—é™çš„ç¯å¢ƒ**ã€‚

- **ä½¿ç”¨åœºæ™¯**ï¼š
  - é€‚åˆ **åµŒå…¥å¼è®¾å¤‡** æˆ– **å­˜å‚¨å—é™çš„ç¯å¢ƒ**ã€‚

---

## 8. `-Oz`ï¼ˆæè‡´ä¼˜åŒ–ä»£ç å¤§å°ï¼‰
- **ç‰¹ç‚¹**ï¼š
  - åœ¨ `-Os` åŸºç¡€ä¸Š **è¿›ä¸€æ­¥ä¼˜åŒ–ä»£ç ä½“ç§¯**ï¼Œå¯èƒ½ç‰ºç‰²ä¸€äº›æ€§èƒ½ã€‚

- **ä½¿ç”¨åœºæ™¯**ï¼š
  - **æç«¯å­˜å‚¨å—é™çš„è®¾å¤‡**ï¼Œå¦‚ **å¾®æ§åˆ¶å™¨**ã€‚

---

## **ä¼˜åŒ–çº§åˆ«æ€»ç»“**
| é€‰é¡¹ | é€‚ç”¨åœºæ™¯ | ä¸»è¦ä¼˜åŒ–å†…å®¹ | é€‚åˆè°ƒè¯• | ä»£ç å¤§å° | ä»£ç æ‰§è¡Œé€Ÿåº¦ |
|------|---------|-------------|---------|---------|---------|
| `-O0` | è°ƒè¯•ã€åˆ†æ | æ— ä¼˜åŒ– | âœ… | å¤§ | æ…¢ |
| `-Og` | è°ƒè¯• + è½»å¾®ä¼˜åŒ– | é€‚åˆè°ƒè¯•çš„ä¼˜åŒ– | âœ… | è¾ƒå¤§ | è¾ƒå¿« |
| `-O1` | ä»£ç ä¼˜åŒ–ä½†ä»å¯è°ƒè¯• | åŸºæœ¬ä¼˜åŒ– | âš ï¸ | ä¸­ | ä¸­ç­‰ |
| `-O2` | ç”Ÿäº§ç¯å¢ƒæ¨è | æ ‡å‡†ä¼˜åŒ–ï¼ˆå¾ªç¯ã€æŒ‡ä»¤è°ƒåº¦ç­‰ï¼‰ | âŒ | å° | å¿« |
| `-O3` | é«˜æ€§èƒ½åº”ç”¨ | æ¿€è¿›ä¼˜åŒ–ï¼ˆè‡ªåŠ¨å‘é‡åŒ–ã€å‡½æ•°å†…è”ç­‰ï¼‰ | âŒ | å¤§ | æ›´å¿« |
| `-Ofast` | è¶…é«˜æ€§èƒ½è®¡ç®— | `-O3` + æµ®ç‚¹ä¼˜åŒ–ï¼ˆå¯èƒ½ä¸ç²¾ç¡®ï¼‰ | âŒ | å¤§ | æœ€å¿« |
| `-Os` | åµŒå…¥å¼ç³»ç»Ÿ | `-O2` + ä»£ç ç¼©å‡ | âš ï¸ | æ›´å° | å¿« |
| `-Oz` | æç«¯å­˜å‚¨å—é™ | `-Os` + è¿›ä¸€æ­¥ç¼©å°ä»£ç  | âŒ | æœ€å° | å¿« |

---

## **å¦‚ä½•é€‰æ‹©ä¼˜åŒ–çº§åˆ«ï¼Ÿ**
- **è°ƒè¯•æ—¶**ï¼šä½¿ç”¨ `-O0` æˆ– `-Og`ï¼Œè¿™æ ·å¯ä»¥æ›´å®¹æ˜“è¿½è¸ªä»£ç æ‰§è¡Œè·¯å¾„ã€‚
- **ä¸€èˆ¬å¼€å‘**ï¼š`-O1` æ—¢æœ‰ä¼˜åŒ–ï¼Œåˆä¸ä¼šæ”¹å˜ä»£ç ç»“æ„å¤ªå¤šã€‚
- **ç”Ÿäº§ç¯å¢ƒ**ï¼š`-O2` æ˜¯**æ¨è**çš„ä¼˜åŒ–çº§åˆ«ï¼Œèƒ½æ˜¾è‘—æå‡æ€§èƒ½ä¸”ä¸ä¼šå¤ªæ¿€è¿›ã€‚
- **é«˜æ€§èƒ½è®¡ç®—**ï¼š`-O3` æˆ– `-Ofast`ï¼Œä½† `-Ofast` å¯èƒ½ä¼šå½±å“æµ®ç‚¹è®¡ç®—çš„æ­£ç¡®æ€§ã€‚
- **å­˜å‚¨å—é™ç¯å¢ƒ**ï¼šä½¿ç”¨ `-Os` æˆ– `-Oz` ä»¥å‡å°‘ä»£ç ä½“ç§¯ã€‚

å¦‚æœä½ çš„ç¨‹åºæ¶‰åŠ **æµ®ç‚¹è®¡ç®—** å¹¶ä¸”è¦æ±‚ä¸¥æ ¼çš„è®¡ç®—ç²¾åº¦ï¼Œè¯·é¿å… `-Ofast`ï¼Œå› ä¸ºå®ƒä¼šè¿å IEEE 754 æ ‡å‡†ã€‚

---

ä½ ç°åœ¨çš„ `float` è®¡ç®—å®éªŒï¼Œæ¨èä½¿ç”¨ `-O0` è¿›è¡Œæµ‹è¯•ï¼Œç¡®ä¿ `printf` è¾“å‡ºçš„ç»“æœä¸ä¼šå—åˆ°ä¼˜åŒ–å½±å“ã€‚è€Œå¦‚æœè¦åˆ†æä¼˜åŒ–åçš„æ±‡ç¼–ä»£ç ï¼Œå¯ä»¥å°è¯• `-O1`ã€`-O2` è¿›è¡Œå¯¹æ¯”ã€‚

# 3. å¸¸ç”¨è°ƒè¯•æŒ‡ä»¤

åœ¨ `gdb` è°ƒè¯•æ—¶ï¼Œä»¥ä¸‹æ˜¯å¸¸ç”¨çš„å‘½ä»¤ï¼Œæ¶µç›– **åŸºæœ¬è°ƒè¯•ã€æ–­ç‚¹ã€å†…å­˜æŸ¥çœ‹ã€å¯„å­˜å™¨åˆ†æã€æ±‡ç¼–è°ƒè¯•** ç­‰æ–¹é¢ã€‚

---

## **1. å¯åŠ¨å’ŒåŠ è½½**
```bash
gdb ./a.out      # å¯åŠ¨ GDB å¹¶åŠ è½½å¯æ‰§è¡Œæ–‡ä»¶
gdb -tui ./a.out # å¯åŠ¨ TUI ç•Œé¢ï¼ˆå¸¦æœ‰ä»£ç å’Œæ±‡ç¼–çª—å£ï¼‰
```
åœ¨ `gdb` ä¸­è¿è¡Œç¨‹åºï¼š
```gdb
(gdb) run        # è¿è¡Œç¨‹åº
(gdb) run arg1 arg2   # è¿è¡Œç¨‹åºå¹¶ä¼ å…¥å‚æ•°
(gdb) start      # è¿è¡Œç¨‹åºå¹¶åœ¨ `main` å¤„åœä¸‹
```

---

## **2. æ–­ç‚¹ï¼ˆBreakpointsï¼‰**
```gdb
(gdb) break main              # åœ¨ main å‡½æ•°å¤„è®¾æ–­ç‚¹
(gdb) break 42                # åœ¨ç¬¬ 42 è¡Œè®¾æ–­ç‚¹
(gdb) break file.c:42         # åœ¨ file.c æ–‡ä»¶çš„ç¬¬ 42 è¡Œè®¾æ–­ç‚¹
(gdb) break func_name         # åœ¨ func_name å¤„è®¾æ–­ç‚¹
(gdb) tbreak func_name        # ä»…è§¦å‘ä¸€æ¬¡çš„æ–­ç‚¹
(gdb) rbreak prefix.*         # è®¾ç½®æ‰€æœ‰åŒ¹é… prefix å¼€å¤´çš„å‡½æ•°æ–­ç‚¹
(gdb) delete 1                # åˆ é™¤ç¼–å· 1 çš„æ–­ç‚¹
(gdb) info breakpoints        # æ˜¾ç¤ºæ‰€æœ‰æ–­ç‚¹
```

---

## **3. è¿è¡Œæ§åˆ¶**
```gdb
(gdb) continue    # ç»§ç»­æ‰§è¡Œåˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹
(gdb) next        # æ‰§è¡Œå½“å‰è¡Œï¼ˆä¸è¿›å…¥å‡½æ•°ï¼‰
(gdb) step        # è¿›å…¥å‡½æ•°å†…éƒ¨æ‰§è¡Œ
(gdb) finish      # è¿è¡Œåˆ°å½“å‰å‡½æ•°è¿”å›
(gdb) until 42    # è¿è¡Œåˆ°ç¬¬ 42 è¡Œ
(gdb) return      # ç›´æ¥è¿”å›å½“å‰å‡½æ•°ï¼ˆå¯èƒ½å¯¼è‡´ç¨‹åºå¼‚å¸¸ï¼‰
(gdb) kill        # ç»ˆæ­¢ç¨‹åº
```

---

## **4. æŸ¥çœ‹å˜é‡**
```gdb
(gdb) print a             # æ‰“å°å˜é‡ a çš„å€¼
(gdb) print/x a           # ä»¥åå…­è¿›åˆ¶æ˜¾ç¤ºå˜é‡ a
(gdb) print/t a           # ä»¥äºŒè¿›åˆ¶æ˜¾ç¤ºå˜é‡ a
(gdb) print &a            # æŸ¥çœ‹ a çš„åœ°å€
(gdb) whatis a            # æŸ¥çœ‹å˜é‡ a çš„ç±»å‹
(gdb) info locals         # æ˜¾ç¤ºæ‰€æœ‰å±€éƒ¨å˜é‡
(gdb) info args           # æ˜¾ç¤ºå½“å‰å‡½æ•°çš„å‚æ•°
(gdb) display a           # æ¯æ¬¡åœæ­¢æ—¶è‡ªåŠ¨æ˜¾ç¤º a
(gdb) undisplay 1         # å–æ¶ˆè‡ªåŠ¨æ˜¾ç¤ºç¼–å· 1
```

---

## **5. æŸ¥çœ‹å†…å­˜**
```gdb
(gdb) x/10d &a           # æŸ¥çœ‹ a çš„å†…å­˜åœ°å€å¤„çš„ 10 ä¸ªåè¿›åˆ¶å€¼
(gdb) x/5x 0x602010      # æŸ¥çœ‹ 0x602010 åœ°å€å¤„çš„ 5 ä¸ªåå…­è¿›åˆ¶æ•°
(gdb) x/20b buf          # æŸ¥çœ‹ buf çš„ 20 ä¸ªå­—èŠ‚ï¼ˆä»¥äºŒè¿›åˆ¶æ˜¾ç¤ºï¼‰
(gdb) x/s ptr            # æŸ¥çœ‹ ptr æŒ‡å‘çš„å­—ç¬¦ä¸²
(gdb) x/4i $pc           # æŸ¥çœ‹å½“å‰ PC æŒ‡ä»¤çš„ 4 æ¡æ±‡ç¼–ä»£ç 
```

æ ¼å¼è¯´æ˜ï¼š
- `d` = decimalï¼ˆåè¿›åˆ¶ï¼‰
- `x` = hexï¼ˆåå…­è¿›åˆ¶ï¼‰
- `b` = byteï¼ˆå­—èŠ‚ï¼‰
- `s` = stringï¼ˆå­—ç¬¦ä¸²ï¼‰
- `i` = instructionï¼ˆæŒ‡ä»¤ï¼‰

---

## **6. æŸ¥çœ‹å¯„å­˜å™¨**
```gdb
(gdb) info registers       # æ˜¾ç¤ºæ‰€æœ‰å¯„å­˜å™¨å€¼
(gdb) info all-registers   # æ˜¾ç¤ºæ‰€æœ‰å¯„å­˜å™¨ï¼ŒåŒ…æ‹¬ FPã€XMMã€SSE
(gdb) print $rax           # æŸ¥çœ‹ rax å¯„å­˜å™¨
(gdb) set $eax=0x1234      # ä¿®æ”¹ eax å¯„å­˜å™¨çš„å€¼
```

---

## **7. æ±‡ç¼–è°ƒè¯•**
```gdb
(gdb) disassemble main      # åæ±‡ç¼– main å‡½æ•°
(gdb) disassemble /m main   # æ˜¾ç¤º C ä»£ç å’Œæ±‡ç¼–æ··åˆ
(gdb) disassemble /r main   # æ˜¾ç¤ºåå…­è¿›åˆ¶æŒ‡ä»¤
(gdb) stepi                # æ‰§è¡Œä¸€æ¡æ±‡ç¼–æŒ‡ä»¤
(gdb) nexti                # æ‰§è¡Œä¸€æ¡æ±‡ç¼–æŒ‡ä»¤ï¼ˆä¸è¿›å…¥è°ƒç”¨ï¼‰
```

---

## **8. æ ˆå’Œå‡½æ•°è°ƒç”¨**
```gdb
(gdb) backtrace         # æ˜¾ç¤ºè°ƒç”¨æ ˆï¼ˆå½“å‰æ‰§è¡Œè·¯å¾„ï¼‰
(gdb) bt                # backtrace çš„ç®€å†™
(gdb) bt full           # æ˜¾ç¤ºå®Œæ•´è°ƒç”¨æ ˆï¼ˆåŒ…å«å˜é‡ï¼‰
(gdb) frame 2           # åˆ‡æ¢åˆ°ç¬¬ 2 å¸§
(gdb) up                # å‘ä¸Šç§»åŠ¨ä¸€å¸§ï¼ˆä¸Šä¸€å±‚å‡½æ•°ï¼‰
(gdb) down              # å‘ä¸‹ç§»åŠ¨ä¸€å¸§ï¼ˆä¸‹ä¸€å±‚å‡½æ•°ï¼‰
```

---

## **9. ä¿®æ”¹å˜é‡**
```gdb
(gdb) set var a=10       # ä¿®æ”¹å˜é‡ a çš„å€¼
(gdb) set *(int*)0x602010 = 42   # ä¿®æ”¹å†…å­˜åœ°å€å¤„çš„å€¼
(gdb) set $rax=0x1234    # ä¿®æ”¹å¯„å­˜å™¨å€¼
```

---

## **10. è°ƒè¯•å…±äº«åº“**
```gdb
(gdb) info sharedlibrary   # æ˜¾ç¤ºåŠ è½½çš„å…±äº«åº“
(gdb) break function@lib.so  # åœ¨å…±äº«åº“çš„å‡½æ•°å¤„è®¾æ–­ç‚¹
(gdb) set environment LD_PRELOAD ./mylib.so  # é¢„åŠ è½½åŠ¨æ€åº“
```

---

## **11. æ¡ä»¶æ–­ç‚¹**
```gdb
(gdb) break 42 if x==5     # å½“ x == 5 æ—¶ï¼Œåœ¨ç¬¬ 42 è¡Œæ–­ç‚¹
(gdb) condition 1 x>10     # è®©æ–­ç‚¹ 1 ä»…åœ¨ x > 10 æ—¶è§¦å‘
```

---

## **12. è®°å½• & å¤ç°**
```gdb
(gdb) record              # å¼€å§‹è®°å½•æ‰§è¡Œè·¯å¾„
(gdb) record stop         # åœæ­¢è®°å½•
(gdb) reverse-continue    # é€†å‘æ‰§è¡Œï¼ˆå›æº¯ï¼‰
(gdb) reverse-step        # é€†å‘å•æ­¥è°ƒè¯•
(gdb) reverse-finish      # é€†å‘æ‰§è¡Œåˆ°å‡½æ•°è¿”å›
```

---

## **13. ä¿å­˜å’ŒåŠ è½½è°ƒè¯•ä¼šè¯**
```gdb
(gdb) save breakpoints bps.txt  # ä¿å­˜æ–­ç‚¹
(gdb) source bps.txt            # é‡æ–°åŠ è½½æ–­ç‚¹
```

---

### **æ€»ç»“**
ğŸ“Œ **åŸºæœ¬æ“ä½œ**
- `run` / `continue` / `next` / `step` / `finish`
- `break` / `delete` / `info breakpoints`
- `print` / `x` / `info registers`
- `backtrace` / `frame` / `up` / `down`

ğŸ“Œ **é«˜çº§æ“ä½œ**
- `disassemble` / `stepi`
- `record` / `reverse-continue`
- `set var` / `set $rax`

è¿™äº›å‘½ä»¤å¯ä»¥è®©ä½  **æ›´é«˜æ•ˆåœ°è°ƒè¯• C ä»£ç ã€åˆ†æå†…å­˜å¸ƒå±€ã€é€†å‘å·¥ç¨‹**ï¼ğŸš€

# 4 åŒæ—¶æŸ¥çœ‹cä¸æ±‡ç¼–

æ¨èä½¿ç”¨layout split

åœ¨ GDB ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ `disassemble /m` æˆ– `layout split` æ¥åŒæ—¶æ˜¾ç¤º **C ä»£ç ** å’Œ **æ±‡ç¼–ä»£ç **ã€‚ä»¥ä¸‹æ˜¯å…·ä½“æ–¹æ³•ï¼š

---

## **æ–¹æ³• 1ï¼šä½¿ç”¨ `disassemble /m`**
å¯ä»¥è®© GDB **æ··åˆæ˜¾ç¤º C ä»£ç å’Œæ±‡ç¼–æŒ‡ä»¤**ï¼š
```gdb
disassemble /m main
```
ğŸ”¹ è¯´æ˜ï¼š
- `disassemble /m` ä»¥ **æ··åˆæ¨¡å¼ï¼ˆmixed modeï¼‰** æ˜¾ç¤º C ä»£ç å’Œå¯¹åº”çš„æ±‡ç¼–æŒ‡ä»¤ã€‚  
- `main` å¯ä»¥æ›¿æ¢æˆä½ æƒ³è¦æŸ¥çœ‹çš„å‡½æ•°åã€‚

å¦‚æœæƒ³è¦æ˜¾ç¤º 16 è¿›åˆ¶æŒ‡ä»¤ï¼š
```gdb
disassemble /r main
```
è¿™æ ·ä¼šåœ¨æ±‡ç¼–ä»£ç åé¢ **é™„å¸¦åå…­è¿›åˆ¶æœºå™¨ç **ï¼Œä¾¿äºåˆ†æã€‚

---

## **æ–¹æ³• 2ï¼šä½¿ç”¨ `layout split`ï¼ˆTUI ç•Œé¢ï¼‰**
å¦‚æœä½ æƒ³ **å®æ—¶åŠ¨æ€æŸ¥çœ‹** C ä»£ç å’Œæ±‡ç¼–ä»£ç ï¼Œå¯ä»¥è¿›å…¥ GDB çš„ TUIï¼ˆText User Interfaceï¼‰æ¨¡å¼ï¼š
```gdb
layout split
```
ğŸ”¹ è¯´æ˜ï¼š
- `layout split` **ä¸Šæ–¹æ˜¾ç¤º C ä»£ç ï¼Œä¸‹æ–¹æ˜¾ç¤ºæ±‡ç¼–ä»£ç **ã€‚
- ä½ å¯ä»¥ç”¨ `stepi` é€æ¡æ‰§è¡ŒæŒ‡ä»¤ï¼Œå¹¶å®æ—¶çœ‹åˆ° C ä»£ç å’Œæ±‡ç¼–çš„å˜åŒ–ã€‚

å¦‚æœåªæƒ³æ˜¾ç¤ºæ±‡ç¼–ä»£ç ï¼š
```gdb
layout asm
```
å¦‚æœæƒ³å›åˆ°æ™®é€š GDB å‘½ä»¤è¡Œæ¨¡å¼ï¼š
```gdb
layout reg
```

---

## **æ–¹æ³• 3ï¼šå¼€å¯ `set disassemble` è‡ªåŠ¨æ··åˆæ¨¡å¼**
å¦‚æœæƒ³åœ¨æ¯æ¬¡ `stepi` æ—¶è‡ªåŠ¨æ˜¾ç¤º C ä»£ç å’Œæ±‡ç¼–ï¼š
```gdb
set disassemble-next-line on
```
è¿™æ ·ï¼Œæ¯æ¬¡å•æ­¥æ‰§è¡Œï¼ˆ`stepi`ï¼‰æ—¶ï¼ŒGDB éƒ½ä¼šæ˜¾ç¤ºå½“å‰æ‰§è¡Œçš„ C ä»£ç å’Œæ±‡ç¼–ä»£ç ã€‚

å¦‚æœä½ ä¸æƒ³è¦è¿™ä¸ªåŠŸèƒ½ï¼š
```gdb
set disassemble-next-line off
```

---

## **æ€»ç»“**
| **æ–¹æ³•**                  | **å‘½ä»¤**                 | **ç‰¹ç‚¹** |
|---------------------------|-------------------------|---------|
| **æ··åˆæ˜¾ç¤º C å’Œæ±‡ç¼–**     | `disassemble /m main`   | åªæ˜¾ç¤ºæŸä¸ªå‡½æ•°çš„ C ä»£ç  + æ±‡ç¼– |
| **æ˜¾ç¤º 16 è¿›åˆ¶æŒ‡ä»¤**      | `disassemble /r main`   | å¸¦æœºå™¨ç çš„æ±‡ç¼– |
| **åŠ¨æ€çª—å£æ¨¡å¼**          | `layout split`          | C ä»£ç  + æ±‡ç¼–åˆ†å±æ˜¾ç¤º |
| **çº¯æ±‡ç¼–æ¨¡å¼**            | `layout asm`            | åªæ˜¾ç¤ºæ±‡ç¼– |
| **è‡ªåŠ¨æ˜¾ç¤º C+æ±‡ç¼–**       | `set disassemble-next-line on` | `stepi` æ—¶è‡ªåŠ¨æ˜¾ç¤º C å’Œæ±‡ç¼– |

å¦‚æœä½ æƒ³ **è¾¹è°ƒè¯•è¾¹çœ‹åˆ° C å’Œæ±‡ç¼–**ï¼Œå»ºè®®ä½¿ç”¨ï¼š
```gdb
layout split
stepi  # å•æ­¥æ‰§è¡Œæ±‡ç¼–æŒ‡ä»¤
```
è¿™æ ·å¯ä»¥ **å®æ—¶è§‚å¯Ÿ C ä»£ç å’Œå¯¹åº”çš„æ±‡ç¼–æŒ‡ä»¤**ï¼Œéå¸¸é€‚åˆå­¦ä¹ å’Œåˆ†æï¼ ğŸš€

# 5. layoutä½¿ç”¨

åœ¨ **GDB TUIï¼ˆText User Interfaceï¼‰æ¨¡å¼** ä¸­ï¼Œ`layout` å‘½ä»¤ç”¨äº **æ”¹å˜çª—å£å¸ƒå±€**ï¼Œå¯ä»¥é€‰æ‹©æ˜¾ç¤º **C ä»£ç ã€æ±‡ç¼–ã€å¯„å­˜å™¨ç­‰ä¿¡æ¯**ã€‚

---

## **1. `layout` å‘½ä»¤çš„æ ¼å¼**
```gdb
layout <layout_name>
```
æˆ–è€…ï¼š
```gdb
layout prev   # åˆ‡æ¢åˆ°ä¸Šä¸€ä¸ªå¸ƒå±€
layout next   # åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªå¸ƒå±€
```

å…¶ä¸­ï¼Œ`<layout_name>` å–å€¼å¦‚ä¸‹ï¼š
| **å¸ƒå±€åç§°** | **åŠŸèƒ½** |
|-------------|---------|
| `src`       | **åªæ˜¾ç¤º C ä»£ç ** |
| `asm`       | **åªæ˜¾ç¤ºæ±‡ç¼–ä»£ç ** |
| `split`     | **åŒæ—¶æ˜¾ç¤º C ä»£ç å’Œæ±‡ç¼–ä»£ç ** |
| `regs`      | **æ˜¾ç¤ºå¯„å­˜å™¨** |

---

## **2. å…·ä½“å¸ƒå±€ä»‹ç»**
### **ğŸ”¹ `layout src`ï¼ˆæºç æ¨¡å¼ï¼‰**
```gdb
layout src
```
- åªæ˜¾ç¤º C ä»£ç ï¼Œä¸æ˜¾ç¤ºæ±‡ç¼–ã€‚
- é€‚åˆé«˜çº§è¯­è¨€è°ƒè¯•ï¼Œä¸å…³æ³¨åº•å±‚æ±‡ç¼–ã€‚

---

### **ğŸ”¹ `layout asm`ï¼ˆæ±‡ç¼–æ¨¡å¼ï¼‰**
```gdb
layout asm
```
- åªæ˜¾ç¤º **æ±‡ç¼–æŒ‡ä»¤**ï¼Œä¸æ˜¾ç¤º C ä»£ç ã€‚
- é€‚åˆè°ƒè¯•åº•å±‚æ±‡ç¼–ï¼Œé€æ­¥è·Ÿè¸ªå¯„å­˜å™¨å˜åŒ–ã€‚

---

### **ğŸ”¹ `layout split`ï¼ˆæºç +æ±‡ç¼–æ¨¡å¼ï¼‰**
```gdb
layout split
```
- **ä¸ŠåŠéƒ¨åˆ†** æ˜¾ç¤º C ä»£ç ï¼Œ**ä¸‹åŠéƒ¨åˆ†** æ˜¾ç¤ºå¯¹åº”çš„æ±‡ç¼–ä»£ç ã€‚
- é€‚åˆæƒ³åŒæ—¶æŸ¥çœ‹ C ä»£ç å’Œæ±‡ç¼–ä»£ç çš„æƒ…å†µã€‚

---

### **ğŸ”¹ `layout regs`ï¼ˆå¯„å­˜å™¨æ¨¡å¼ï¼‰**
```gdb
layout regs
```
- æ˜¾ç¤º CPU **æ‰€æœ‰å¯„å­˜å™¨**ã€‚
- é€‚åˆåˆ†æå¯„å­˜å™¨å˜åŒ–ï¼Œä¾‹å¦‚ `eax`ã€`rsp`ã€`rbp` ç­‰ã€‚

---

## **3. åˆ‡æ¢å¸ƒå±€**
- `layout prev`ï¼šå›åˆ°ä¸Šä¸€ä¸ªå¸ƒå±€ã€‚
- `layout next`ï¼šåˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªå¸ƒå±€ã€‚

ç¤ºä¾‹ï¼š
```gdb
layout split  # åˆ‡æ¢åˆ° C ä»£ç  + æ±‡ç¼–æ¨¡å¼
layout regs   # åˆ‡æ¢åˆ°å¯„å­˜å™¨æ¨¡å¼
layout prev   # å›åˆ°ä¸Šä¸€ä¸ªå¸ƒå±€
layout next   # åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªå¸ƒå±€
```

---

## **4. ç»“åˆ `stepi` è¿›è¡Œè°ƒè¯•**
```gdb
layout split      # åŒæ—¶æ˜¾ç¤º C ä»£ç å’Œæ±‡ç¼–
set disassemble-next-line on  # è®© GDB è‡ªåŠ¨æ˜¾ç¤ºå½“å‰æ±‡ç¼–æŒ‡ä»¤
start             # è¿è¡Œç¨‹åº
stepi             # é€æ­¥æ‰§è¡Œä¸€æ¡æ±‡ç¼–æŒ‡ä»¤
info registers    # æŸ¥çœ‹å¯„å­˜å™¨çŠ¶æ€
```
---

## **æ€»ç»“**
| **å‘½ä»¤**        | **ä½œç”¨** |
|----------------|---------|
| `layout src`   | åªæ˜¾ç¤º C ä»£ç  |
| `layout asm`   | åªæ˜¾ç¤ºæ±‡ç¼–ä»£ç  |
| `layout split` | C ä»£ç  + æ±‡ç¼– |
| `layout regs`  | æ˜¾ç¤ºå¯„å­˜å™¨ |
| `layout prev`  | åˆ‡æ¢åˆ°ä¸Šä¸€ä¸ªå¸ƒå±€ |
| `layout next`  | åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªå¸ƒå±€ |

å¦‚æœä½ æƒ³åŒæ—¶æŸ¥çœ‹ C ä»£ç å’Œæ±‡ç¼–ï¼Œå¹¶è¿›è¡Œå•æ­¥è°ƒè¯•ï¼š
```gdb
layout split
stepi
info registers
```
è¿™æ ·ä½ å°±å¯ä»¥ **ç²¾å‡†æ§åˆ¶æ¯æ¡æŒ‡ä»¤çš„æ‰§è¡Œ**ï¼ğŸš€
